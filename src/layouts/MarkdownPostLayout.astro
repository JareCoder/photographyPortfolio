---
import BaseLayout from "./BaseLayout.astro";
import Prose from "../components/Prose.astro";
import { Image } from "astro:assets";
const { frontmatter } = Astro.props;
const updatedDate = frontmatter?.updatedDate
  .toDateString()
  .split(" ")
  .slice(1)
  .join(" ");
const publishedDate = frontmatter?.pubDate
  .toDateString()
  .split(" ")
  .slice(1)
  .join(" ");
const title = frontmatter?.title;
const description = frontmatter?.description;
// const author = frontmatter?.author.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
const author = frontmatter?.author;
const image = frontmatter.image?.src;
const alt = frontmatter.image?.alt;
import dayjs from "dayjs";
import utc from "dayjs/plugin/utc";

dayjs.extend(utc);

const lastModified = dayjs()
  .utc(Astro.props.frontmatter.lastModified)
  .format("MMM DD YYYY");
---

<BaseLayout
  title={title}
  image={image}
  alt={alt}
  description={description}
  author={author}
  pubDate={updatedDate}
  updatedDate={publishedDate}
>
  {
    image ? (
    <div style="visibility: hidden; width: 0; height: 0;">
      <Image
        id="backgroundImage"
        src={image}
        alt={alt}
        width={3840}
        height={2160}
        decoding="async"
        loading="eager"
        format="avif"
      /></div>
      <div
        id="backgroundImageElement"
        class="bg-fixed bg-center-33 bg-cover bg-no-repeat flex flex-col justify-center items-center text-center h-[450px] sm:h-[500px] md:h-[600px] lg:h-[800px] xl:h-[1080px] mb-8 lg:-mx-16 -mx-8"
        style={`background-position: 30% 50%;`}
      >
        <h1 class="prose prose-slate uppercase font-overpass-mono text-[rgb(245,245,245)] text-4xl">
          {title}
        </h1>
        <div class="flex gap-2 mt-2">
          {frontmatter.tags.map((tag) => (
            <p class="bg-slate-600 text-[rgb(245,245,245)] bg-opacity-50 px-2 py-1 rounded font-overpass-mono text-xl">
              <a class="no-underline font-overpass-mono" href={`../tags/${tag}`}>
                {tag}
              </a>
            </p>
          ))}
        </div>
      </div>
    ) : (
      <Prose>
        <h1 class="normal-case font-overpass-mono text-4xl -mb-1">{title}</h1>
        <div class="flex">
          {frontmatter.tags.map((tag) => (
            <p class="bg-slate-600 bg-opacity-50 px-2 py-1 rounded">
              <a
                class="no-underline font-overpass-mono text-[rgb(245,245,245)] text-xl"
                href={`../tags/${tag}`}
              >
                {tag}
              </a>
            </p>
          ))}
        </div>
        <slot />
      </Prose>
    )
  }
  <Prose>
    <slot />
    <div class="flex flex-col sm:flex-row align-center">
      <div class="w-full flex-col sm:w-1/2 text-center sm:text-left">
        <p>-- <a href="/about/" class="no-underline font-lekton"> {author}</a></p>
      </div>
      <div
        class="w-full flex-col sm:w-1/2 text-left sm:text-right mt-[10px] font-lekton"
      >
        <div>
          Published: {publishedDate}
        </div>
        <div>
          Updated: {updatedDate}
        </div>
      </div>
    </div>
  </Prose>
</BaseLayout>
<script src="../scripts/markdownheroimage.js"></script>
